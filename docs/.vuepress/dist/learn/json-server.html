<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>David Blog | json-server</title>
    <meta name="description" content="Just playing around">
    
    
    <link rel="preload" href="/blogg/assets/css/8.styles.b9d07457.css" as="style"><link rel="preload" href="/blogg/assets/js/app.cfcf68d8.js" as="script"><link rel="preload" href="/blogg/assets/js/4.053b43ae.js" as="script"><link rel="prefetch" href="/blogg/assets/js/5.27e60175.js"><link rel="prefetch" href="/blogg/assets/js/1.74d46db3.js"><link rel="prefetch" href="/blogg/assets/js/2.cf6da9e9.js"><link rel="prefetch" href="/blogg/assets/js/3.958ef80e.js"><link rel="prefetch" href="/blogg/assets/js/0.0f82dda1.js"><link rel="prefetch" href="/blogg/assets/js/6.549236b1.js"><link rel="prefetch" href="/blogg/assets/js/7.f14bda27.js">
    <link rel="stylesheet" href="/blogg/assets/css/8.styles.b9d07457.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/blogg/" class="home-link router-link-active"><!----><span class="site-name">
      David Blog
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/blogg/diary/" class="nav-link">日记</a></div><div class="nav-item"><a href="/blogg/learn/" class="nav-link router-link-active">学习</a></div><div class="nav-item"><a href="/blogg/project/" class="nav-link">项目</a></div><!----></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blogg/diary/" class="nav-link">日记</a></div><div class="nav-item"><a href="/blogg/learn/" class="nav-link router-link-active">学习</a></div><div class="nav-item"><a href="/blogg/project/" class="nav-link">项目</a></div><!----></nav><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>学习</span><!----></p><ul class="sidebar-group-items"><li><a href="/blogg/learn/json-server.html" class="active sidebar-link">json-server</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blogg/learn/json-server.html#什么是json-server" class="sidebar-link">什么是json-server</a></li><li class="sidebar-sub-header"><a href="/blogg/learn/json-server.html#使用" class="sidebar-link">使用</a></li><li class="sidebar-sub-header"><a href="/blogg/learn/json-server.html#简单的环境部署" class="sidebar-link">简单的环境部署</a></li></ul></li><li><a href="/blogg/learn/vue-router.html" class="sidebar-link">vue-router</a></li></ul></div></li></ul></div><div class="page"><div class="content"><h1 id="json-server"><a href="#json-server" aria-hidden="true" class="header-anchor">#</a> json-server</h1><p>​想把自己做的一个仿照bilibili评论区放在百度云上,可涉及到linux系统安装mongodb并不会弄无法解决数据库问题也就无法解决接口问题,而涉及到的翻页和刷新保存数据必须要用到数据库o(╥﹏╥)o, 最终决定选择使用<strong>json-server</strong>来解决,</p><h2 id="什么是json-server"><a href="#什么是json-server" aria-hidden="true" class="header-anchor">#</a> 什么是json-server</h2><p>​	先来理解下什么是RESTful接口, 这里推荐<a href="http://www.ruanyifeng.com/blog/2014/05/restful_api" target="_blank" rel="noopener noreferrer">阮一峰老师的博客<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>简单来说.不同的请求方式, 代表着对网络资源不同的处理方式.</p><table><thead><tr><th>Methods</th><th style="text-align:center">Operate</th><th>Example</th></tr></thead><tbody><tr><td>get</td><td style="text-align:center">获取服务器资源</td><td>访问百度页面</td></tr><tr><td>post</td><td style="text-align:center">对服务器上的数据进行添加</td><td>注册QQ号码</td></tr><tr><td>patch</td><td style="text-align:center">修改服务器的资源</td><td>修改QQ个人信息</td></tr><tr><td>delete</td><td style="text-align:center">删除服务器资源</td><td>删除论坛评论</td></tr></tbody></table><p>所以<strong>json-server</strong>就是用来模拟后台接口,且接口的设计采用了RESTful方式.</p><h2 id="使用"><a href="#使用" aria-hidden="true" class="header-anchor">#</a> 使用</h2><p>先创建一个db.json文件, 用来模拟后台数据,如下</p><div class="language-json extra-class"><pre class="language-json"><code>db.json
<span class="token punctuation">{</span>
  <span class="token property">&quot;friends&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  	  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;david&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;age&quot;</span><span class="token operator">:</span> <span class="token number">14</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  	  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;yusifeng&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;age&quot;</span><span class="token operator">:</span> <span class="token number">14</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  	  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zhaobaiwan&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;age&quot;</span><span class="token operator">:</span> <span class="token number">14</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>对象中必须包含<code>id</code>属性, 类似于一般数据库的索引</p></div><h3 id="get获取数据"><a href="#get获取数据" aria-hidden="true" class="header-anchor">#</a> GET获取数据</h3><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> axios <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'axios'</span><span class="token punctuation">)</span>

<span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  method<span class="token punctuation">:</span> <span class="token string">'get'</span><span class="token punctuation">,</span>
  url<span class="token punctuation">:</span> <span class="token string">'127.0.0.1:3000'</span><span class="token punctuation">,</span>
  params<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  	                                <span class="token comment">//空参则检索所有字段</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>                <span class="token comment">//输出db.json全部类容</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//params参数</span>
<span class="token punctuation">{</span>
	q<span class="token punctuation">:</span><span class="token string">'d'</span><span class="token punctuation">,</span>				        <span class="token comment">//全局查找, 也就是查找每个对象中是否有关键字d</span>
	_limit<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> 			        <span class="token comment">//类似于数据库中查找个数, 每次获取相同个数的数据就可以做类似翻页</span>
	_page<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>			        <span class="token comment">//_page的值为0或者1都表示第一页</span>
	_sort<span class="token punctuation">:</span> <span class="token string">'age'</span><span class="token punctuation">,</span>		        <span class="token comment">//按照age的顺序来排列</span>
	_order<span class="token punctuation">:</span> <span class="token string">'age'</span><span class="token punctuation">,</span>
	_start<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> 			        <span class="token comment">//从第3个开始查找一般配合_end 或者 _limit</span>
	_end<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> 			        <span class="token comment">//配合_start 类似于Array.slice(3, 5) 即包左不包右</span>
	<span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">_gte`</span></span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>	        <span class="token comment">//key属性大于5的全部检索出来</span>
	<span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">_lte`</span></span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>	        <span class="token comment">//${key}属性小于10的全部检索出来</span>
	<span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">_ne`</span></span><span class="token punctuation">:</span> <span class="token number">4</span> <span class="token punctuation">,</span>	        <span class="token comment">//${key}的值不等于4的全部检索</span>
	_embed<span class="token punctuation">:</span> $<span class="token punctuation">{</span>key<span class="token punctuation">}</span><span class="token punctuation">,</span>		        <span class="token comment">//给所在对象添加一个字键且值为空数组</span>
	_expand<span class="token punctuation">:</span> 
<span class="token punctuation">}</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>根据<code>param</code>的参数的不同配置, 可以获取不同的返回数据,</p></div><h3 id="post添加数据"><a href="#post添加数据" aria-hidden="true" class="header-anchor">#</a> POST添加数据</h3><div class="language-js extra-class"><pre class="language-js"><code><span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  method<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
  url<span class="token punctuation">:</span> <span class="token string">'http://localhost:3000/comments'</span><span class="token punctuation">,</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>	                         <span class="token comment">//id会自动递增添加类似于mySQL的key</span>
    name<span class="token punctuation">:</span> <span class="token string">'invoker'</span><span class="token punctuation">,</span>
    age<span class="token punctuation">:</span> <span class="token number">312</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  headers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'application/json'</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span> 	        <span class="token comment">//添加的数据,添加完成后db.json数据会变动</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>err <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="patch修改数据"><a href="#patch修改数据" aria-hidden="true" class="header-anchor">#</a> PATCH修改数据</h3><div class="language-js extra-class"><pre class="language-js"><code><span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  method<span class="token punctuation">:</span> <span class="token string">'patch'</span><span class="token punctuation">,</span>
  url<span class="token punctuation">:</span> <span class="token string">'http://localhost:3000/friends/2'</span><span class="token punctuation">,</span>

  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;age&quot;</span><span class="token punctuation">:</span> <span class="token number">2333</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  headers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'application/json'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span>			 <span class="token comment">//返回修改后的数据</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>err <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-json extra-class"><pre class="language-json"><code>db.json中的数据变化

<span class="token punctuation">{</span>                                                     <span class="token punctuation">{</span>
  ...													...		
  <span class="token punctuation">{</span>														<span class="token punctuation">{</span>
     <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>											   <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  	 <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zhaobaiwan&quot;</span><span class="token punctuation">,</span>     =&gt;						   <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zhaobaiwan&quot;</span><span class="token punctuation">,</span>
     <span class="token property">&quot;age&quot;</span><span class="token operator">:</span> <span class="token number">14</span>											   <span class="token property">&quot;age&quot;</span><span class="token operator">:</span> <span class="token number">2333</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>													<span class="token punctuation">}</span><span class="token punctuation">,</span>
  ...													...
<span class="token punctuation">}</span>													  <span class="token punctuation">}</span>
</code></pre></div><h3 id="delete删除数据"><a href="#delete删除数据" aria-hidden="true" class="header-anchor">#</a> DELETE删除数据</h3><div class="language-js extra-class"><pre class="language-js"><code><span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  method<span class="token punctuation">:</span> <span class="token string">'delete'</span><span class="token punctuation">,</span>
  url<span class="token punctuation">:</span> <span class="token string">'http://localhost:3000/friends/2'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span>			
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>err <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//直接将id为2的对象删除</span>
</code></pre></div><h2 id="简单的环境部署"><a href="#简单的环境部署" aria-hidden="true" class="header-anchor">#</a> 简单的环境部署</h2><p>想要真实的运用于生产, 需要单独编写一个nodejs脚本来运行</p><div class="language-js extra-class"><pre class="language-js"><code>datebase<span class="token punctuation">.</span>js				<span class="token comment">//命名不要带有- 我用pm2 上线的时候出现了问题, 去掉-就好了</span>

<span class="token keyword">let</span> jsServer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'json-server'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> server <span class="token operator">=</span> jsServer<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> router <span class="token operator">=</span> jsServer<span class="token punctuation">.</span><span class="token function">router</span><span class="token punctuation">(</span><span class="token string">'db.json'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> middlewares <span class="token operator">=</span> jsServer<span class="token punctuation">.</span><span class="token function">defaults</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

server<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>middlewares<span class="token punctuation">)</span>
server<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">27017</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">'running at port 27017'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="danger custom-block"><p class="custom-block-title">WARNING</p><p>命名不要带有 <code>-</code> 我用pm2 上线的时候出现了问题, 去掉<code>-</code>就好了.</p></div><div class="language-bash extra-class"><pre class="language-bash"><code>$ pm2 start datebase.js	
</code></pre></div><p><strong>更多关于json-server, 请<a href="https://www.npmjs.com/package/json-server" target="_blank" rel="noopener noreferrer">访问官网<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></strong></p></div><div class="content edit-link"><!----><!----></div><div class="content page-nav"><p class="inner"><!----><span class="next"><a href="/blogg/learn/vue-router.html">
          vue-router
        </a> →
      </span></p></div></div></div></div>
    <script src="/blogg/assets/js/4.053b43ae.js" defer></script><script src="/blogg/assets/js/app.cfcf68d8.js" defer></script>
  </body>
</html>
